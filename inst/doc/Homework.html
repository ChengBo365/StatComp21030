<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="by 21030" />

<meta name="date" content="2021-12-21" />

<title>Homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">by 21030</h4>
<h4 class="date">2021-12-21</h4>



<div id="the-homework-1" class="section level1">
<h1>The homework 1</h1>
<div id="questions" class="section level2">
<h2>Questions</h2>
<p>Give three simple examples including text,figures,and tables by using knitr.</p>
</div>
<div id="texts" class="section level2">
<h2>Texts</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Some simple codes are written as follows:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">2.6</span>, <span class="fl">3.3</span>,<span class="fl">4.5</span>,<span class="fl">6.1</span>,<span class="fl">6.9</span>,<span class="fl">7.5</span>,<span class="fl">8.4</span>,<span class="fl">9.8</span>,<span class="fl">10.1</span>,<span class="fl">11.2</span>,<span class="fl">12.8</span>,<span class="fl">13.5</span>,<span class="fl">14.4</span>,<span class="fl">15.4</span>,<span class="fl">16.7</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.98</span>,<span class="fl">0.87</span>,<span class="fl">0.85</span>,<span class="fl">0.80</span>,<span class="fl">0.74</span>,<span class="fl">0.69</span>,<span class="fl">0.65</span>,<span class="fl">0.60</span>,<span class="fl">0.52</span>,<span class="fl">0.49</span>,<span class="fl">0.44</span>,<span class="fl">0.39</span>,<span class="fl">0.28</span>,<span class="fl">0.19</span>,<span class="fl">0.15</span>,<span class="fl">0.08</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">12.6</span>,<span class="fl">13.1</span>,<span class="dv">14</span>,<span class="fl">15.1</span>,<span class="fl">16.8</span>,<span class="fl">17.2</span>,<span class="fl">18.3</span>,<span class="fl">19.1</span>,<span class="fl">20.1</span>,<span class="fl">21.2</span>,<span class="fl">22.3</span>,<span class="fl">23.5</span>,<span class="fl">24.6</span>,<span class="fl">25.4</span>,<span class="fl">26.7</span>,<span class="fl">27.8</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">53</span>,<span class="dv">56</span>,<span class="dv">57</span>,<span class="fl">58.9</span>,<span class="fl">59.9</span>,<span class="fl">60.4</span>,<span class="fl">61.9</span>,<span class="fl">62.8</span>,<span class="fl">63.9</span>, <span class="dv">65</span>, <span class="fl">66.4</span>,<span class="fl">68.2</span>,<span class="fl">69.9</span>,<span class="fl">70.8</span>,<span class="fl">72.2</span>,<span class="dv">74</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>fun1<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span><span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>fun1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ I(x1^2) + x1 + x2 + x3)
## 
## Coefficients:
## (Intercept)      I(x1^2)           x1           x2           x3  
##   64.874799    -0.002834     0.803319   -11.113530    -0.101092</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fun1)<span class="sc">$</span>coef </span></code></pre></div>
<pre><code>##                  Estimate  Std. Error    t value     Pr(&gt;|t|)
## (Intercept)  64.874798657 7.921901086  8.1892967 5.226238e-06
## I(x1^2)      -0.002834001 0.009315406 -0.3042274 7.666326e-01
## x1            0.803318777 0.495033489  1.6227564 1.329264e-01
## x2          -11.113530242 5.921585642 -1.8767828 8.730953e-02
## x3           -0.101092012 0.476458879 -0.2121736 8.358519e-01</code></pre>
</div>
<div id="table" class="section level2">
<h2>table</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let&#39;s take a look at the data about the island by using a table.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(islands))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Africa</td>
<td align="right">11506</td>
</tr>
<tr class="even">
<td align="left">Antarctica</td>
<td align="right">5500</td>
</tr>
<tr class="odd">
<td align="left">Asia</td>
<td align="right">16988</td>
</tr>
<tr class="even">
<td align="left">Australia</td>
<td align="right">2968</td>
</tr>
<tr class="odd">
<td align="left">Axel Heiberg</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">Baffin</td>
<td align="right">184</td>
</tr>
</tbody>
</table>
<p>The head function means that only the first six data are taken. Let us see data about rock:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(rock))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">area</th>
<th align="right">peri</th>
<th align="right">shape</th>
<th align="right">perm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4990</td>
<td align="right">2791.90</td>
<td align="right">0.0903296</td>
<td align="right">6.3</td>
</tr>
<tr class="even">
<td align="right">7002</td>
<td align="right">3892.60</td>
<td align="right">0.1486220</td>
<td align="right">6.3</td>
</tr>
<tr class="odd">
<td align="right">7558</td>
<td align="right">3930.66</td>
<td align="right">0.1833120</td>
<td align="right">6.3</td>
</tr>
<tr class="even">
<td align="right">7352</td>
<td align="right">3869.32</td>
<td align="right">0.1170630</td>
<td align="right">6.3</td>
</tr>
<tr class="odd">
<td align="right">7943</td>
<td align="right">3948.54</td>
<td align="right">0.1224170</td>
<td align="right">17.1</td>
</tr>
<tr class="even">
<td align="right">7979</td>
<td align="right">4010.15</td>
<td align="right">0.1670450</td>
<td align="right">17.1</td>
</tr>
</tbody>
</table>
</div>
<div id="figure" class="section level2">
<h2>Figure</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the graph of fun1 is shown as follows:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fun1)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The <code>echo = FALSE</code> parameter are aimed at preventing printing of the R code . Another example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a> x4<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">mean=</span><span class="fl">1.5</span>,<span class="at">sd=</span><span class="dv">2</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(x4)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We get a set of data with a mean of 1.5 and a variance of 2.</p>
</div>
</div>
<div id="the-homework-2" class="section level1">
<h1>The homework 2</h1>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>#3.4 由运行结果知，对任意Sigma，模拟结果都接近实际图形</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Develop an algorithm to generate random samples from a Rayleigh(σ) distribution</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">3</span>) <span class="co">#取随机数</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(a)) {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> a[[i]]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="co"># F(x) = 1-exp(-x^2/2/sigma^2)  x&gt;=0</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#作图</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, .<span class="dv">01</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y, y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(sigma)  <span class="co">#输出结果</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 2.041337</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 1.136157</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 1.361108</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 1.146613</code></pre>
<p><img src="data:image/png;base64,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S3sW+FMlbuv1BbIDOrwM3oEsNSCxNOTaQqZyrVyL3XmsG6w0m7C4N3Zu9hO1+g5fM08NCOSwWTGCYbrLiBtQefWTHVAZ/lKM5ICaQuxGAAG5t9cvXfhq/442qPjM3cIZlBqQuPjuIoAAOZclK2cOeQ23A+KvnqkpBRHKEFAFuhnrq5ZPJ6+9RMMaovyqGH60xo6/8Y4AubZpG2vxRvoEADn34VN9mBMLOQmE9fXLd/NuQO69ZAUaUEfsJcgruaYVbhRdER6u3eWHZ155Csd6ju0rfuHWbaR9BgMOQG0dsRsoUAVyt0EeyTXRYBWIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQUO6A+LNqyisql1fugORb3ldT7oBO1eVfr+PeYB6n7AGdirAfn6RW/oCqwGfmEit7QE933666a2P2gMqrf8FTrfMqd0B8a8K4V79GKndA4sHoFZvp3AGtLgIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAf0PrtqtYKU4OuYAAAAASUVORK5CYII=" /><!-- --></p>
<pre><code>## [1] 1.231996</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 1.311259</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 1.277865</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOmZmZgBmZmZmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa2kJC227a22/+2/7a2/9u2///T09PbkDrbtmbb/9vb////tmb/tpD/25D/27b//7b//9v///+WmeOKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALkUlEQVR4nO2di3akuBGGZY/bu5PdZHov2STjXIdJ4mTNxqSn3e//ZkEIgQQqfoGEpO7Uf+acMTSqKn2tO7QQF9aiRO4AShcDAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQOUAOj0K8TG9DZQkIyDb9fn48dLcfQqyOLHhzttKt8UAah5eL29PYUVoYsMHEHRbDCAp+XWGarThwwe7jQHo7R9/G/7+7+9ePVM5PNcPXolNfws2vAG1SeiwIwD68uOzcXT68We/ZHPP9b1XUtsfbcMXUJeEDDsA0Pn7rv0//2A3caev/QjNPNd+TfTUH2lDOfjygxB3v36dnJ0nocIOAFS1nj+1LdyHqUe/ijL17Fl+5v4IG8q+7MVbvfvZOutKQoS9HdDbU2d6/r2fHheyQDo+feXXxS+VM8uGUEGKP7Sl6El8MM86kxBhhwCSyM/HGfieHNDUcdV907AXc/gjbAh1+cH4b9EtEfZmQI00fGj/O6ijQ+ft42X8b5bgYH5GOv7y57bqyk5lTFDd//uzEN88D1YWLTvsD4CWsusOOxRQ1RdeaV0HXzsyMblkcPzL++4rFEO56BuNg5mguv+tPCcrVyUcFcG27MhYo1PpszO3ZNiBVayt4wr7+Xj/z2NfRhvhrAbmJdpvI8Qk0kr8pjX7uesfdYJK3P1VnjuM/mjLjoydHrV50i0ZdiCg81EHXIv3+s9GqGArHcZhdknv93y8a9vQxhilnR4PyvjBSFB1DbNsJEZ/lkzL84ydHoeGnXJrhk3aWakJoPa71SXU7cm6ZOiEu6JfH4ZQ+xqmvludoFL22g6MAGRaNu13qsW7Z/vs3C0ddjRA7V/aPgXIuKT326jUp8ch1wMgeaVOMAc0KZym5Um+WnZjzRlq2NQtHXasNqgN+Sf9LerKPK1ixiXDV9mlPh+HltcajegEYxVzt0Gm5Um+3p7MVp10a4ZtK3QcpHuVpuvRVPBEL2Zeot1WXUwGlbenu9+3p36RTdGQoJKVpGuk3b2YaXmSLev0eHbqlg47FFDfu55lJ6I7i9r5LVuXiOHkw/Ply/fvxrLd17G2zIwJqrv3uta5xkGWZTtbVo0dMzt3S4YdaSStvqi6+3qJIal5idFEfLbnkmqgKL59NhO0A8X25LevF/dI2rJsZ2voz21ADrfRR9Jam+ZiK71WRuh+c37vtaBR0edivdSIxZTHbD4A0Nyft/1lr9Fn81qz9aBv8FQ1ANDyetCi/eUCRIQdYUXx7Y9mxIvrfRtlAZr4iyQy7Chr0n831qT/4rsmHcdfJNFhl3PjsFAxICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQFlAmS5FSV/S3lim3otmFCW0GZOCy5DOSJz4SiWUOrAhCXzfOJAfJUc0MtL+68XRaskpQckDEAvhhiQ8mdSsQGVSSh9G/RCAiqSUEGAyuzJMjTSJKAiCZUFqEBCiUMSi4BKLEJlASqQUNqIBANC3gCg8gglDUh4ACqNUFpAoBdLHpCHygNUGKGU4XQdOQJUWhEqEFBZhMoDVFgRShiNGuhgQGURihOM17Lg/zMgL3MIUJnrr+kA9QNBGpD5JwNaBFTS8isDAkoAyG5cvAAV1CClAGTm3xeQdRA3xnUanJ+P7k1tNpozz20BZFW48Li2y3Bet4XZZ4tIT3PjOTP71wzoEoFRPEBmrx8SUaimzmu9104cc905s0R4t0FFApLbEX3sd06KYE6fM3Pv30gbt/C3RhNDo/O2le53OWu2F6EbBnQ+Bu64b5szz20DZKQJj2u7RkDfKT4BxedCAqKeeLlGQJ77XiNz5rmNgMaeLyCgYPXOq3Fcv0c3f/2AxhIUyZx5biugYfQdIbDNWue8Fv2G31RFdAMiHyq7NUB1tz9mt5FxGkCiFEDn4wc5DBr3rHRKvZCgG0emAfRSDCA/6Ve8VA+vqwAJgGEBkLgqQMMrLapDIkAvJQGSuyvXwr0dfS+NZb6/9dyccS4AkBoxhmQwVKPztuLIDeWrpWUzvaMw+eqMGwbUvYlMvn5hj5H0dkDdtDUgoGBZgOSeqbtMNW4BUFu35GbW40teFrWumw8BlPsuorUedPfJa7dmh5WlOzS3Amgvc963wqiDW78vdjOA3p7QVMPjmj0AlVLFKtx9DS8eaKhVo3leFp/8vSZAk9eUuGS8PY/a2H8fQDkJWeMgIOMSaji5E6CMhAbXHh18thKU86G80XWDXzBYj28Q822DRPA4qAOUj5D5dAfuxfRF5JR/J0AZi9De46BYgLIRuhJA+YqQ4bitPw+vVdgTQvsBykXIaKTvPtVyNh/1xmGXtxiAshUho5v/0HXecdeD4gHKRcgaKEpAcVcU4wDK+cjrrARV25+euuwFyPwvG6C+DXK/6G+DufEwFqA894DsXky9TzmOueHwZgDtYC4uoCz3gK4LUIZbHJO5WFALfZkC6vvnaIBy3APS/vo32taBz9rvDCjDLY7eX6Mb58kLojeas46iAso0DjJWyxbvzXuas49iAkq//Do8QKVPxJxq3BIguNq8xpx9EBVQckK7ALInT7EBpSUUB9BkKmlNniIwsQ4ST+v3KUFWvqIDSkpIAxrLQPGA0hLaZaqxM6CklewqAaUkdH2AEi8v7gdIeGR2+0H/HcSNns5RZHMpAKVaPbtWQIoQA1o4SLR6dr2AJKFrBiRQ/sIPrrsXSwAoycz+qgGlGBRdOSCrxsXNipWjyOaE3VTsCcjYSIcBuQ/GjWXiZsXKUWRzSQG97Pvj6HVWPX+KkBjQrvOOVVZ9f4qQGpDasCo/IO8Hya3OJQUg1eEHgaC0xqr3TxEyANptXH0rJehlr0K0sg3y+ylCJkDq9lMQDipHvvL8KUI2QJf4jPYZByVjYh3sMjG7JUAOWrFytFrLv5svAVAfiENJAE2tTO7NX4HSArphMSCgyJPV21PkyertKfJUozdatPYD5P2Y1YJR+qP8nwRf7l+CtnyU/5Pwy/FkFRrNj2HXgSKcrEKj+TFkGUn7G82PgQFt/iTG5cFG82NgQJs/iXF5sNH8GEoAdEtiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgoPiAmqVtrE5fO++GdDck3cvc9ZI594ZramHYuQfJ6ZH4gFR0QHIfmYbK0vnovF309tQmqJ2Ry8dISHONe3H89BVFtGmv93zvg1ZsQOrWELGFTEPctFZ78rgeqel2XaF2cu62DnW5oW7aqeDWbd8SGxCd1+5m0dINR7KgUIDqhz85AdVUEaGLFq3ogLoYSA5LgMhN9Ws3udaVuw2qfkW0aM39v45rX+IYG5AqBnSrQQOibkY2RJZkfXECki+YaSk5EtWyhq98t0oxgBq6d3G/WxlsG+rypIriuu1bSqliizezXbw7RwuAXJuxqaZx3TZtKRvpCw1oefc9Z2b7h1mozLoaZOV9XVOdtJsnAZE7yCo0ZLlzliA6jXp+J28VWx4oEsGdHsnyIxEYj904PnWclV+Pc2v1etGaU/GnGotzAzegvro4k1UL1Yhqg+g0DTmlocSTVSAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBApQOSz6oZr6hMr9IB6be8Z1PpgOSzzd+FvcE8TMUDulQrf30SWeUDaugn8FKoeEBvTz9l3bWxeED1w3/WPZYaWaUDko82h736NVClA1LPSWdspksHlF0MCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwL6H6WBLwo4SAJEAAAAAElFTkSuQmCC" /><!-- --></p>
<pre><code>## [1] 1.541825</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 1.42209</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 2.466094</code></pre>
<p>#3.11 由运行结果知，当P接近0.5时，会出现双峰混合</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a random sample of size 1000 from a normal location mixture</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fl">0.75</span><span class="sc">*</span>X1<span class="fl">+0.25</span><span class="sc">*</span>X2</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z1, <span class="at">prob =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> p<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>X2</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z2, <span class="at">prob =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(p)<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 0.511</code></pre>
<p>#3.20 比较几次运行结果发现，模拟效果都较好，理论期望和方差与模拟出来的很接近</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Write a program to simulate a compound Poisson(λ)–Gamma process (Y has a Gamma distribution)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="dv">2</span>;beta<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="dv">10</span>;lambda<span class="ot">&lt;-</span><span class="dv">5</span>   <span class="co">#lambda为5;t为10时</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,t<span class="sc">*</span>lambda)  </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,r,beta);</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  X1[j]<span class="ot">&lt;-</span>(<span class="fu">sum</span>(y))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  y1[j]<span class="ot">&lt;-</span>(y[<span class="dv">1</span>])</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>X1   <span class="co">#模拟产生X1的100个值</span></span></code></pre></div>
<pre><code>##   [1] 26.67410 17.32801 28.87882 20.75048 21.02150 25.41500 28.39604 24.40717
##   [9] 28.02793 29.07062 23.93686 33.40526 30.58167 21.19005 25.14626 24.27024
##  [17] 25.36455 25.72653 24.70447 16.02644 28.39603 17.19915 23.38731 29.72835
##  [25] 24.63942 21.12837 31.91390 28.86499 32.89281 21.73821 17.52856 29.21229
##  [33] 22.86874 27.03130 26.98428 27.33783 34.17838 27.42824 25.82687 32.15779
##  [41] 27.97578 17.84105 26.08346 23.09739 31.02846 30.24370 21.86369 33.46469
##  [49] 29.43241 22.84214 23.01892 23.17636 24.50428 25.92024 27.49668 21.85568
##  [57] 27.38408 21.16584 23.51258 23.18518 26.09578 24.77365 21.59391 24.24442
##  [65] 21.97087 25.67438 26.18534 20.83576 26.31588 27.29302 20.97683 23.30603
##  [73] 22.99846 28.27886 26.00843 21.58223 22.80374 26.93436 27.89176 18.25509
##  [81] 20.85132 27.54561 24.62828 19.75306 24.36776 30.76245 20.72949 23.60383
##  [89] 19.50930 26.17442 30.01523 21.43645 23.82580 27.47842 33.77807 20.24386
##  [97] 18.86310 26.68739 23.38360 26.41897</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X1)</span></code></pre></div>
<pre><code>## [1] 25.09933</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X1)</span></code></pre></div>
<pre><code>## [1] 16.14121</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>EX<span class="ot">&lt;-</span>t<span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">mean</span>(y1);EX  <span class="co">#理论期望</span></span></code></pre></div>
<pre><code>## [1] 26.14139</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>VarX<span class="ot">&lt;-</span>t<span class="sc">*</span>lambda<span class="sc">*</span>(<span class="fu">var</span>(y1)<span class="sc">+</span>(<span class="fu">mean</span>(y1))<span class="sc">^</span><span class="dv">2</span>);VarX  <span class="co">#理论方差</span></span></code></pre></div>
<pre><code>## [1] 21.41435</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="dv">2</span>;beta<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="dv">10</span>;lambda<span class="ot">&lt;-</span><span class="dv">10</span>   <span class="co">#lambda为10;t为10时</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,t<span class="sc">*</span>lambda) </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,r,beta)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  X2[j]<span class="ot">&lt;-</span>(<span class="fu">sum</span>(y))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  y1[j]<span class="ot">&lt;-</span>(y[<span class="dv">1</span>])</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>X2   <span class="co">#模拟产生X2的100个值</span></span></code></pre></div>
<pre><code>##   [1] 52.82054 48.05147 65.52084 54.86528 53.18455 41.03843 60.82594 58.79974
##   [9] 44.47983 52.08856 48.63267 48.51692 40.04193 41.60813 53.19814 44.84764
##  [17] 53.90962 50.96066 54.91329 38.50112 41.80562 47.16225 53.14623 34.21168
##  [25] 45.98065 56.36872 44.93224 49.20663 59.06285 55.62287 64.94777 45.38282
##  [33] 47.01904 43.72395 55.53953 54.95962 48.05500 56.48289 59.55826 60.03982
##  [41] 48.66774 62.96436 50.53225 50.20416 55.25446 61.14440 40.55429 42.11207
##  [49] 41.64506 52.98825 45.59666 47.51688 44.14499 51.28934 47.93322 48.10946
##  [57] 63.36746 47.62825 41.14756 56.73383 48.34484 59.53611 42.01196 39.56891
##  [65] 56.81751 47.39413 45.13513 47.10483 40.81586 52.81195 42.01843 51.61649
##  [73] 61.63420 45.40379 55.59514 46.59014 47.01336 49.42919 62.80545 46.89609
##  [81] 53.55127 58.93116 51.42405 48.45301 56.50885 53.01067 37.11705 41.06886
##  [89] 57.63839 47.87117 51.32363 48.59809 46.79835 46.83117 52.03152 42.74097
##  [97] 45.25223 55.58059 49.14912 47.29585</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X2)</span></code></pre></div>
<pre><code>## [1] 50.09268</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X2)</span></code></pre></div>
<pre><code>## [1] 45.6282</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>EX<span class="ot">&lt;-</span>t<span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">mean</span>(y1);EX  <span class="co">#理论期望</span></span></code></pre></div>
<pre><code>## [1] 44.25654</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>VarX<span class="ot">&lt;-</span>t<span class="sc">*</span>lambda<span class="sc">*</span>(<span class="fu">var</span>(y1)<span class="sc">+</span>(<span class="fu">mean</span>(y1))<span class="sc">^</span><span class="dv">2</span>);VarX  <span class="co">#理论方差</span></span></code></pre></div>
<pre><code>## [1] 28.86159</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="dv">2</span>;beta<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>X3<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">10</span>;lambda<span class="ot">=</span><span class="dv">10</span>  <span class="co">#lambda为10;t为10时</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,t<span class="sc">*</span>lambda) </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,r,beta)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  X3[j]<span class="ot">&lt;-</span>(<span class="fu">sum</span>(y))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  y1[j]<span class="ot">&lt;-</span>(y[<span class="dv">1</span>])</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>X3   <span class="co">#模拟产生X3的100个值</span></span></code></pre></div>
<pre><code>##   [1] 107.55654  96.48313  70.55086  84.23565  99.91299 109.41352  91.17938
##   [8]  96.85838 100.95081 102.91325  99.34776  93.92400 118.86252 105.03476
##  [15]  96.97798  94.40719  97.80828  95.95839  92.28940  90.29750  88.65854
##  [22] 103.09956  97.36614 105.46950 101.20619 107.61007 107.66504 114.67668
##  [29] 112.73902  83.21100 129.43281 102.45142  95.02096 106.66362 110.08522
##  [36] 114.96626 106.29182  87.33114  80.93958 112.42657  80.73800 109.52493
##  [43] 112.73858  98.58419  82.33745  83.57221  95.21430 115.62821  80.97807
##  [50]  92.69271  84.91325  92.73571 105.42174  93.70439 120.38524 105.51305
##  [57]  99.49163 129.03164  99.78669 112.33536 110.16665 118.96547 107.93886
##  [64] 103.85993 106.34529 109.82325 101.62640  83.54198 105.21813  99.13104
##  [71]  95.77066  87.26403  84.34897 113.30166  99.87228 114.81368 110.88734
##  [78] 103.28890 104.73973  93.35557 114.92211  88.38894  94.81691  91.47451
##  [85] 102.13299 104.21843  91.49371 113.27909 100.61717  97.96965 105.35395
##  [92]  99.20534 101.21806  91.80646  93.68510  92.03077 100.09514 108.68939
##  [99] 105.55980  91.12693</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X3)</span></code></pre></div>
<pre><code>## [1] 100.4995</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X3)</span></code></pre></div>
<pre><code>## [1] 118.3227</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>EX<span class="ot">&lt;-</span>t<span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">mean</span>(y1);EX  <span class="co">#理论期望</span></span></code></pre></div>
<pre><code>## [1] 99.67615</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>VarX<span class="ot">&lt;-</span>t<span class="sc">*</span>lambda<span class="sc">*</span>(<span class="fu">var</span>(y1)<span class="sc">+</span>(<span class="fu">mean</span>(y1))<span class="sc">^</span><span class="dv">2</span>);VarX  <span class="co">#理论方差</span></span></code></pre></div>
<pre><code>## [1] 161.1102</code></pre>
<p>#改变beta的值为2，仍与模拟结果近似</p>
</div>
</div>
<div id="the-homework-3" class="section level1">
<h1>The homework 3</h1>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>#5.4</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>MC.Phi<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(m,<span class="dv">0</span>,x)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  cdf<span class="ot">&lt;-</span><span class="fu">mean</span>(x<span class="sc">*</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span>);cdf </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare the estimates with the values returned by the pbeta function in R.</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>a[i]</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  theta.hat<span class="ot">&lt;-</span><span class="fu">MC.Phi</span>(x)<span class="sc">/</span><span class="fu">MC.Phi</span>(<span class="dv">1</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">&lt;-</span><span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(theta.hat,theta)) <span class="co">#输出结果</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.008639891 0.008560000
## [1] 0.05778365 0.05792000
## [1] 0.1630815 0.1630800
## [1] 0.3168235 0.3174400
## [1] 0.4983568 0.5000000
## [1] 0.6910914 0.6825600
## [1] 0.8356125 0.8369200
## [1] 0.9459301 0.9420800
## [1] 0.979937 0.991440</code></pre>
<p>#根据拟合结果看，和实际值比较接近</p>
<p>#5.9<br />
<span class="math display">\[
  f(x) = \frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}, \quad x\ge 0, \sigma&gt;0.
\]</span> <span class="math display">\[
  令\sigma=1可得
f(x) = xe^{-x^2/2}, \quad x\ge 0, \sigma=1.
\]</span> #当x1,x2独立时,var((x1+x2)/2)=var(x)/2</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Implement a function to generate samples from a Rayleigh(σ) distribution,using antithetic variables</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>MC.P1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">R =</span> <span class="dv">10000</span>) {</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> a</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(a, v)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    g<span class="ot">&lt;-</span> x[i] <span class="sc">*</span>x[i]<span class="sc">*</span>u <span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x[i]<span class="sc">*</span>u)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    cdf[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(g)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>MC.P2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">R =</span> <span class="dv">10000</span>) {</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">c</span>(a,v)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    g<span class="ot">&lt;-</span> x[i] <span class="sc">*</span>x[i]<span class="sc">*</span>u <span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x[i]<span class="sc">*</span>u)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    cdf[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(g)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>MC1<span class="ot">&lt;-</span>MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC.P1</span>(x, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC.P2</span>(x, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>V1<span class="ot">&lt;-</span><span class="fu">var</span>(MC1);V1</span></code></pre></div>
<pre><code>## [1] 0.0003777475</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>V2<span class="ot">&lt;-</span><span class="fu">var</span>(MC2)<span class="sc">/</span><span class="dv">2</span>;V2</span></code></pre></div>
<pre><code>## [1] 0.0001767483</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>V2<span class="sc">/</span>V1</span></code></pre></div>
<pre><code>## [1] 0.4679006</code></pre>
<p>#5.13</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find two importance functions</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="fu">exp</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span>x<span class="sc">*</span>e<span class="sc">^</span>{x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>e<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>})),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>x<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x}))</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (a)</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f1, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (b)</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">2.2</span>), <span class="at">lwd =</span> w, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&#39;(B)&#39;</span>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f1, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">4</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>##       f0    f1    f2
## me 0.204 0.312 0.313
## sd 0.100 0.156 0.449</code></pre>
<p>比较计算得到的均值方差，可以发现f1优于f2,但这两个函数都没有有效降低方差。</p>
<p>#5.14</p>
<p><span class="math display">\[
  今x=1/t,则
\int_{1}^{\infty}\frac{x^{2}}{\sqrt(2\pi )}e^{-x^2/2}dx = \int_{0}^{1}\frac{1}{\sqrt(2\pi )\ast  t^{4}}e^{-1/(2t^2)}dt, \quad 0&lt;t&lt; 1.
\]</span></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtain a Monte Carlo estimate</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>) </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span>x<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g2</span>(u)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>u)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))  <span class="co">#取f(x)=e^(-x)/(1-e^(-1))</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>cdf<span class="ot">&lt;-</span><span class="fu">mean</span>(fg);cdf</span></code></pre></div>
<pre><code>## [1] 0.4723669</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>a1<span class="ot">&lt;-</span><span class="fu">integrate</span>(g1,<span class="dv">1</span>,<span class="cn">Inf</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>a2<span class="ot">&lt;-</span><span class="fu">integrate</span>(g2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(a1,a2))</span></code></pre></div>
<pre><code>## $value
## [1] 0.400626
## 
## $abs.error
## [1] 5.677732e-07
## 
## $subdivisions
## [1] 3
## 
## $message
## [1] &quot;OK&quot;
## 
## $call
## integrate(f = g1, lower = 1, upper = Inf)
## 
## $value
## [1] 0.400626
## 
## $abs.error
## [1] 4.53383e-08
## 
## $subdivisions
## [1] 3
## 
## $message
## [1] &quot;OK&quot;
## 
## $call
## integrate(f = g2, lower = 0, upper = 1)</code></pre>
<p>比较三个结果发现，使用重要样本得到的结果与直接计算结果较为接近。</p>
</div>
</div>
<div id="the-homework-4" class="section level1">
<h1>The homework 4</h1>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>#6.5 <span class="math inline">\(\textbf{1.Thought}\)</span> According to the formula <span class="math display">\[
  \bar{x} \pm t_{1-\alpha / 2}(n-1) s / \sqrt{n}
\]</span> we can cluculate 95% confidence interval of <span class="math inline">\(x\)</span>.Then we compare the average value of <span class="math inline">\(\chi^{2}(2)\)</span>,which is 2,with Upper and lower bound. We do it 10000 times and take average to get proportion.</p>
<p><span class="math inline">\(\textbf{2.Program}\)</span></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a function is written to get confidence interval</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>wf1<span class="ot">&lt;-</span><span class="cf">function</span>(n,alpha){</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  UCL11 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  UCL12<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span> <span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(UCL11,UCL12)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then, A loop of 10000 times is done to calculate the probablity of UCL11&lt;2 and UCL12&gt;2,Which is our coverage probability.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the probablity of UCL11&lt;2 and UCL12&gt;2</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>data1<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> n)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  data1[,i]<span class="ot">=</span><span class="fu">wf1</span>(<span class="dv">20</span>,<span class="fl">0.05</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(data1[<span class="dv">1</span>,]<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">&amp;</span>data1[<span class="dv">2</span>,]<span class="sc">&gt;</span><span class="dv">2</span>))<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 0.915</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>new.t1<span class="ot">&lt;-</span><span class="fu">mean</span>(data1[<span class="dv">1</span>,])</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>new.t2<span class="ot">&lt;-</span><span class="fu">mean</span>(data1[<span class="dv">2</span>,])</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>new.t1</span></code></pre></div>
<pre><code>## [1] 1.098664</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>new.t2</span></code></pre></div>
<pre><code>## [1] 2.89198</code></pre>
<p><span class="math inline">\(\textbf{3.Analysis}\)</span> The coverage probability is about <span class="math inline">\(0.91\)</span>,which is lower than 0.95. The reason is that t distribution is a heavy tail distribution.</p>
<p><span class="math inline">\(\textbf{Compared with example 6.4}\)</span>,when the data comes from a normal distribution, the probability interval of coverage is approximately 95.6%. But when the data is not normally distributed, from the chi-square distribution, the t-distribution is still a good estimate.</p>
<p>#6A</p>
<p><span class="math inline">\(\textbf{1.Thought}\)</span> according to the first question,we can judge whether to reject the original hypothesis by confidence interval.</p>
<p>1.sampled population is <span class="math inline">\(\chi^{2}(1)\)</span></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>wf1<span class="ot">&lt;-</span><span class="cf">function</span>(n,alpha){</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  UCL11 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  UCL12<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span> <span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(UCL11,UCL12,u)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>data1<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> n)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  data1[,i]<span class="ot">=</span><span class="fu">wf1</span>(<span class="dv">20</span>,<span class="fl">0.05</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>VCL1<span class="ot">&lt;-</span><span class="fu">mean</span>(data1[<span class="dv">1</span>,])</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>UCL1<span class="ot">&lt;-</span><span class="fu">mean</span>(data1[<span class="dv">2</span>,])</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>U1<span class="ot">&lt;-</span><span class="fu">mean</span>(data1[<span class="dv">3</span>,])</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(VCL1,UCL1,U1))</span></code></pre></div>
<pre><code>## [1] 0.3798606 1.6175501 0.9987054</code></pre>
<p>2.sampled population is <span class="math inline">\(\upsilon \left ( 0,2 \right )\)</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>wf2<span class="ot">&lt;-</span><span class="cf">function</span>(n,alpha){</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  UCL11 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  UCL12<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span> <span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(UCL11,UCL12,u)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> n)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  data2[,i]<span class="ot">=</span><span class="fu">wf2</span>(<span class="dv">20</span>,<span class="fl">0.05</span>)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>VCL2<span class="ot">&lt;-</span><span class="fu">mean</span>(data2[<span class="dv">1</span>,])</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>UCL2<span class="ot">&lt;-</span><span class="fu">mean</span>(data2[<span class="dv">2</span>,])</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>U2<span class="ot">&lt;-</span><span class="fu">mean</span>(data2[<span class="dv">3</span>,])</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(VCL2,UCL2,U2))</span></code></pre></div>
<pre><code>## [1] 0.7326323 1.2699730 1.0013026</code></pre>
<p>3.sampled population is E(1)</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>wf3<span class="ot">&lt;-</span><span class="cf">function</span>(n,alpha){</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  UCL11 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  UCL12<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span> <span class="fu">sd</span>(x) <span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(UCL11,UCL12,u)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>data3<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> n)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  data3[,i]<span class="ot">=</span><span class="fu">wf3</span>(<span class="dv">20</span>,<span class="fl">0.05</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>VCL3<span class="ot">&lt;-</span><span class="fu">mean</span>(data3[<span class="dv">1</span>,])</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>UCL3<span class="ot">&lt;-</span><span class="fu">mean</span>(data3[<span class="dv">2</span>,])</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>U3<span class="ot">&lt;-</span><span class="fu">mean</span>(data3[<span class="dv">3</span>,])</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(VCL3,UCL3,U3))</span></code></pre></div>
<pre><code>## [1] 0.5515331 1.4470199 0.9992765</code></pre>
<p>按照三个样本的运行结果，发现均值都处在置信区间内部，因此接受原假设</p>
<p>#1.What is the corresponding hypothesis test problem?</p>
<p>Test whether the power is equal.</p>
<p>#2.What test should we use? Z-test, two-sample t-test, paired-ttest or McNemar test? Why?</p>
<p>I think we can use paired-test,because the sample have strong correlation, and guarantee the same type 1 error.</p>
<p>#3.Please provide the least necessary information for hypothesistesting.</p>
<p>we need the di=xi-yi value of each experiment,and di are independent of each other and obey the same normal distribution.</p>
</div>
</div>
<div id="the-homework-5" class="section level1">
<h1>The homework 5</h1>
<p>#answer</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Skewness chisq.test</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">80</span>, <span class="dv">100</span>) <span class="co">#sample sizes</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span>    <span class="co">#for ease of calculation,we could choose d=2.</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">95</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#计算b_{1, d}</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,n) {    </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  S<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  ybar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(y)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(x,y)    <span class="co">#计算协方差</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  sigma.hat<span class="ot">&lt;-</span><span class="fu">ginv</span>(sigma) </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>      S[i,j]<span class="ot">&lt;-</span>((x[i,]<span class="sc">-</span>xbar)<span class="sc">%*%</span>sigma.hat<span class="sc">%*%</span><span class="fu">t</span>(<span class="fu">t</span>(y[j,]<span class="sc">-</span>ybar)))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(S))</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))  </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>                   </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)      </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span>n[i]</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(a<span class="sc">*</span><span class="dv">2</span>),<span class="at">nrow=</span>a,<span class="at">ncol=</span><span class="dv">2</span>)   <span class="co">#生成X，Y随机阵</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(a<span class="sc">*</span><span class="dv">2</span>),<span class="at">nrow=</span>a,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x,y,a) <span class="sc">&gt;=</span> cv ) </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)         <span class="co">#计算拒绝P值</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.355 0.408 0.432 0.445 0.464 0.468</code></pre>
<p>p.reject都很大，说明拒绝原假设，多元偏度大于0。</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Power of the skewness test of chi-squared</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2500</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.15</span>, <span class="fl">0.01</span>), <span class="fu">seq</span>(<span class="fl">0.15</span>, <span class="dv">1</span>, <span class="fl">0.05</span>))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>pw <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">95</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { </span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  skt<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma);b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(a,<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(b,<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>    skt[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x,y,<span class="dv">5</span>) <span class="sc">&gt;=</span> cv)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  pw[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(skt)</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pw <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pw) <span class="sc">/</span> m) <span class="co">#add standard errors</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>pw;se</span></code></pre></div>
<pre><code>##  [1] 0.3360 0.3232 0.3492 0.3672 0.3780 0.3988 0.3896 0.3896 0.4356 0.4180
## [11] 0.4332 0.4276 0.4452 0.4568 0.4316 0.4292 0.4260 0.4408 0.4456 0.4468
## [21] 0.4532 0.4444 0.4272 0.4292 0.3984 0.3964 0.3952 0.3764 0.3624 0.3528
## [31] 0.3572 0.3320 0.3248 0.3352</code></pre>
<pre><code>##  [1] 0.009446777 0.009353967 0.009534345 0.009640833 0.009697752 0.009793029
##  [7] 0.009753191 0.009753191 0.009916706 0.009864603 0.009910353 0.009894609
## [13] 0.009939758 0.009962605 0.009905987 0.009899240 0.009889874 0.009929660
## [19] 0.009940637 0.009943234 0.009956099 0.009937980 0.009893435 0.009899240
## [25] 0.009791373 0.009782986 0.009777872 0.009689645 0.009613870 0.009556823
## [31] 0.009583489 0.009418620 0.009366001 0.009441207</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pw, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="the-homework-6" class="section level1">
<h1>The homework 6</h1>
<p>7.7</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use bootstrap to estimate the bias and standard error of θ</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)   <span class="co">#生成种子</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)  <span class="co">#加载程辑包</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values <span class="co">#初始lambda值</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>the.hat <span class="ot">&lt;-</span> lambda_hat[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda_hat)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co"># number of bootstrap samples</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor) <span class="co"># number of rows (data size)</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行Bootstrap抽样</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, index){</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> dat[index,]</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda)</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>bootstrap_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">cbind</span>(scor<span class="sc">$</span>mec, scor<span class="sc">$</span>vec, scor<span class="sc">$</span>alg, scor<span class="sc">$</span>ana, scor<span class="sc">$</span>sta),</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> func, <span class="at">R =</span> B)</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>theta_b <span class="ot">&lt;-</span> bootstrap_result<span class="sc">$</span>t</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>bias_boot <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta_b) <span class="sc">-</span> the.hat</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated bias of theta_hat, using bootstrap</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>se_boot <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(theta_b))</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated standard error (se) of theta_hat, using bootstrap</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>the.hat,<span class="at">estimate=</span><span class="fu">mean</span>(theta_b),<span class="at">bias_boot=</span>bias_boot,<span class="at">se_boot=</span>se_boot),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##  original  estimate bias_boot   se_boot 
##   0.61912   0.62075   0.00163   0.04708</code></pre>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:The estimated value of lambda is 0.619.The deviation is only 0.003, it can be seen that the Bootstrap method works better. The standard deviation value is 0.049.</p>
<p>7.8</p>
<p>#Load the package and read in the data to calculate the data covariance matrix. Show the first five rows of data.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the data covariance matrix</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap) <span class="co">#for the score data</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(scor)</span></code></pre></div>
<pre><code>##          mec       vec       alg       ana       sta
## mec 305.7680 127.22257 101.57941 106.27273 117.40491
## vec 127.2226 172.84222  85.15726  94.67294  99.01202
## alg 101.5794  85.15726 112.88597 112.11338 121.87056
## ana 106.2727  94.67294 112.11338 220.38036 155.53553
## sta 117.4049  99.01202 121.87056 155.53553 297.75536</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#show a part of data</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>scor[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span></code></pre></div>
<pre><code>##   mec vec alg ana sta
## 1  77  82  67  67  81
## 2  63  78  80  70  81
## 3  75  73  71  66  81
## 4  55  72  63  70  68
## 5  63  63  65  70  63</code></pre>
<p>A function that defines a covariance matrix</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#A function that defines a covariance matrix</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>mcov <span class="ot">&lt;-</span> <span class="cf">function</span>(x,j) <span class="fu">cov</span>(x[j,])</span></code></pre></div>
<p>We obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Computing data dimension</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">lengths</span>(scor)[<span class="dv">1</span>]</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the real covariance matrix</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>real.cov <span class="ot">&lt;-</span> <span class="fu">mcov</span>(scor,<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the real theta value</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>the.hat<span class="ot">&lt;-</span><span class="fu">eigen</span>(real.cov)<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(real.cov)<span class="sc">$</span>values)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Define variables to store values</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>the.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Loop n times</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  the.cov <span class="ot">&lt;-</span> <span class="fu">mcov</span>(scor,(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>i])</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Get matrix eigenvalues</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  eig1<span class="ot">&lt;-</span><span class="fu">eigen</span>(the.cov)<span class="sc">$</span>values</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Find the estimate of lambda</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  the.jack[i]<span class="ot">&lt;-</span>eig1[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eig1)</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculation bias</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>bias1 <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(the.jack)<span class="sc">-</span>the.hat)</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating  standard deviation</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((the.jack<span class="sc">-</span>the.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>the.hat,<span class="at">estimate=</span><span class="fu">mean</span>(the.jack),<span class="at">bias1=</span>bias1,</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">se1=</span>se1),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  original  estimate bias1.mec   se1.mec 
##    0.6191    0.6191    0.0011    0.0496</code></pre>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:The estimated value of lambda is 0.619.The deviation is only 0.001, it can be seen that the Jacknife method works better. The standard deviation value is 0.05</p>
<p>7.9</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute 95% percentile and BCa confidence intervals for θ</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> lambda_hat[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda_hat)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co"># number of bootstrap samples</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor) <span class="co"># number of rows (data size)</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, index){</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> dat[index,]</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co">#对数据进行B=2000次Bootstrap抽样</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>bootstrap_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">cbind</span>(scor<span class="sc">$</span>mec, scor<span class="sc">$</span>vec, scor<span class="sc">$</span>alg, scor<span class="sc">$</span>ana, scor<span class="sc">$</span>sta),</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> func, <span class="at">R =</span> B)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(bootstrap_result,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>ci.perc<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]   <span class="co">#计算得到95%的percentile和BCa的置信区间</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>ci.bca<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(ci.perc,ci.bca),<span class="dv">4</span>)</span></code></pre></div>
<p>Compute 95% percentile confidence intervals is(0.522,0.708),and 95% BCa confidence intervals is(0.522,0,707).</p>
<p>7.B</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the skewness with the following function</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,j) {</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[j])</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x[j] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x[j] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span> )</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><span class="math inline">\(\text{Normal distribution}\)</span></p>
<p>We take a sample with a normal distribution of N(0,2), the sample size is 20, and each time we do bootstrap 1000 times, we cycle 1000 experiments. The coverage of the interval is calculated based on the experimental results.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare the coverage rates</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>me<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>nor.norm<span class="ot">&lt;-</span>nor.basic<span class="ot">&lt;-</span>nor.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  data.nor<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  nor.ske<span class="ot">&lt;-</span><span class="fu">boot</span>(data.nor,<span class="at">statistic=</span>sk,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  nor<span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(nor.ske,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  nor.norm[i,]<span class="ot">&lt;-</span>nor<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  nor.basic[i,]<span class="ot">&lt;-</span>nor<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  nor.perc[i,]<span class="ot">&lt;-</span>nor<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the coverage probability of a normal distribution</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="fu">mean</span>(nor.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>me <span class="sc">&amp;</span> nor.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>me),</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(nor.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>me <span class="sc">&amp;</span> nor.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>me),</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(nor.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>me <span class="sc">&amp;</span> nor.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>me))</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the probability of the left side of the normal distribution</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm.left=&#39;</span>,<span class="fu">mean</span>(nor.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span>me ),</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic.left =&#39;</span>,<span class="fu">mean</span>(nor.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span>me ),</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc.left =&#39;</span>,<span class="fu">mean</span>(nor.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span>me))</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the right side probability of a normal distribution</span></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm.right=&#39;</span>,<span class="fu">mean</span>(nor.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span>me ),</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic.right =&#39;</span>,<span class="fu">mean</span>(nor.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span>me ),</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc.right =&#39;</span>,<span class="fu">mean</span>(nor.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span>me))</span></code></pre></div>
<p><span class="math inline">\(\text{Chi-square distribution}\)</span> Calculating true skewness using Monte Carlo method.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>pian.real<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr =</span> {</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  x0<span class="ot">&lt;-</span><span class="fu">rchisq</span>(<span class="dv">1000</span>,<span class="dv">5</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>((x0<span class="dv">-5</span>)<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pian.real)</span></code></pre></div>
<pre><code>## [1] 1.269027</code></pre>
<p>We take a sample with a normal distribution of <span class="math inline">\(\chi^{2}(5)\)</span>, the sample size is 20, and each time we do bootstrap 1000 times, we cycle 1000 experiments. The coverage of the interval is calculated based on the experimental results.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>me<span class="ot">&lt;-</span>pian.real</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>chi.norm<span class="ot">&lt;-</span>chi.basic<span class="ot">&lt;-</span>chi.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  data.chisq<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  chisq.ske<span class="ot">&lt;-</span><span class="fu">boot</span>(data.chisq,<span class="at">statistic=</span>sk,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  chi<span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(chisq.ske,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  chi.norm[i,]<span class="ot">&lt;-</span>chi<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>  chi.basic[i,]<span class="ot">&lt;-</span>chi<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>  chi.perc[i,]<span class="ot">&lt;-</span>chi<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the coverage probability of the chi-square distribution</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="fu">mean</span>(chi.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>me <span class="sc">&amp;</span> chi.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>me),</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(chi.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>me <span class="sc">&amp;</span> chi.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>me),</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(chi.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>me <span class="sc">&amp;</span> chi.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>me))</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the probability of the left side of the chi-square distribution</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm.left=&#39;</span>,<span class="fu">mean</span>(chi.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span>me ),</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic.left =&#39;</span>,<span class="fu">mean</span>(chi.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span>me ),</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc.left =&#39;</span>,<span class="fu">mean</span>(chi.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span>me))</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the right side probability of the chi-square distribution</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm.right=&#39;</span>,<span class="fu">mean</span>(chi.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span>me ),</span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic.right =&#39;</span>,<span class="fu">mean</span>(chi.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span>me ),</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc.right =&#39;</span>,<span class="fu">mean</span>(chi.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span>me))</span></code></pre></div>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:The coverage interval of the skewness of the normal distribution is much better than the chi-square distribution. The interval coverage probability of a normal distribution is greater than 0.9, and the chi-square distribution is approximately 0.7.</p>
</div>
<div id="the-homework-7" class="section level1">
<h1>The homework 7</h1>
<p>##answer</p>
<p>8.2</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement the bivariate Spearman rank correlation test for independence as a permutation test</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#自行生成0到10的十个随机数</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>) </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#重复次数</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#集中样本</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span> </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)<span class="sc">$</span>statistic</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sample</span>(N, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)  <span class="co">#产生样本指标</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[n]</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>n] <span class="co">#z中拿走x1后剩下的给y1</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x1, y1)<span class="sc">$</span>statistic <span class="co">#相关系数检验</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))   </span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>p_value<span class="ot">&lt;-</span><span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">p=</span>p,<span class="at">p_value=</span>p_value),<span class="dv">3</span>)</span></code></pre></div>
<p>由于生成的是随机数，所以每次运行结果的P值并不相同，但可以看到这两个结果还是比较接近的。而且P值大于0.1，不能拒绝原假设，即X，Y不相关。（批改时如果运行结果差异较大，建议可以多运行几次）</p>
<p>##Exercise2</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">#NN检验函数</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;=</span> n1); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1)</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>#1.Unequal variances and equal expectations</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#生成均值为0，方差为1的随机阵</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#生成均值为0，方差为2的随机阵</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p_values<span class="sc">&lt;</span>alpha)</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<p>可以看到三次检验中Ball的检验效果最好。</p>
<p>#2.Unequal variances and unequal expectations</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#生成均值为0，方差为1的随机阵</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#生成均值为1，方差为2的随机阵</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p_values<span class="sc">&lt;</span>alpha)</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<p>三种检验都很显著，并拒绝原假设，即X，Y不是同分布</p>
<p>#3.Non-normal distributions: t distribution with 1 df (heavy-taileddistribution), bimodel distribution (mixture of two normal distributions)</p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#t distribution with 1 df</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>),<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#生成自由度为1的t分布的随机阵</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>),<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#生成自由度为1的t分布的随机阵</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p_values<span class="sc">&lt;</span>alpha)</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bimodel distribution</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n1<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span>n2<span class="sc">*</span><span class="dv">2</span>);b<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n1<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span>n2<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>);</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  M1<span class="ot">&lt;-</span><span class="fl">0.3</span><span class="sc">*</span>a<span class="fl">+0.7</span><span class="sc">*</span>b</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(M1,<span class="at">nrow=</span>n1,<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#mixture of two normal distributions</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(M1,<span class="at">nrow=</span>n2,<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#mixture of two normal distributions</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p_values<span class="sc">&lt;</span>alpha)</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<p>小于0.05的P值概率很小，即P值大于0.05，接受原假设，即X，Y同分布，但无法看出三次检验的显著性。</p>
<p>#4.Unbalanced samples (say, 1 case versus 10 controls)</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">5</span>;n2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">20</span>);b<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">200</span>,<span class="dv">1</span>,<span class="dv">2</span>);</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#分别抽取10个和100个样本</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(a, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)   </span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(b, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#生成随机阵</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(m1,<span class="at">ncol=</span><span class="dv">2</span>)  </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(m2,<span class="at">ncol=</span><span class="dv">2</span>)  </span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>  p_values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p_values<span class="sc">&lt;</span>alpha)</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.197 0.436 0.870</code></pre>
<p>三次检验中Ball比较显著</p>
<p>#5.Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
<p>The answer is the same as the forth question,likewise the powers are distinguishable which from 0.1 to 0.8,and the Ball method is more powerful.</p>
</div>
<div id="the-homework-8" class="section level1">
<h1>The homework 8</h1>
<p>##Anwerse</p>
<p>9.3</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> (pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fu">abs</span>(xt))</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="dv">0</span>, <span class="fu">abs</span>(y))</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>  den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y,<span class="dv">0</span>, <span class="fu">abs</span>(xt))</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">&lt;-</span>num<span class="sc">/</span>den</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r<span class="sc">&gt;</span><span class="dv">1</span>) r<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(k)</span></code></pre></div>
<pre><code>## [1] 3966</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare the deciles of the generated observations with the deciles of the standard Cauchy distribution</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">1001</span><span class="sc">:</span><span class="dv">10000</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> x[index]</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">quantile</span>(y0, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">qcauchy</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>) </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(y1,y2)</span></code></pre></div>
<pre><code>##          10%       20%        30%        40%        50%       60%       70%
## y1 -3.457329 -1.443593 -0.7589215 -0.3182376 0.01960148 0.3774192 0.7567737
## y2 -3.077684 -1.376382 -0.7265425 -0.3249197 0.00000000 0.3249197 0.7265425
##         80%      90%
## y1 1.448088 3.451549
## y2 1.376382 3.077684</code></pre>
<p>结果十分近似</p>
<p>9.8</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use the Gibbs sampler to generate a chain with target joint density f(x, y)</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>   <span class="co">#n取20,a,b取2</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m, <span class="dv">2</span>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  x[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> x[i,<span class="dv">1</span>]</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  x[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[<span class="dv">101</span><span class="sc">:</span>m, ]</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(x)</span></code></pre></div>
<pre><code>## [1] 9.7844444 0.4869938</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Question3}\)</span> # <code>{r} # #抽样函数 # Gelman.Rubin &lt;- function(psi) { #   psi &lt;- as.matrix(psi) #   n &lt;- ncol(psi) #   k &lt;- nrow(psi) #   psi.means &lt;- rowMeans(psi)      #   B &lt;- n * var(psi.means)         #   psi.w &lt;- apply(psi, 1, &quot;var&quot;)   #   W &lt;- mean(psi.w)               #   v.hat &lt;- W*(n-1)/n + (B/n)      #   r.hat &lt;- v.hat / W              #   return(r.hat) # } #</code> # #9.3 # <code>{r} # #正态马氏链 # normal.chain &lt;- function(sigma, N, X1) { #   x &lt;- rep(0, N) #   x[1] &lt;- X1 #   u = runif(N) #   for (i in 2:N) { #     xt &lt;- x[i-1] #     y &lt;- rnorm(1, xt, sigma)  #     r1 &lt;- dcauchy(y, 0, 1) * dnorm(xt, y, sigma) #     r2 &lt;- dcauchy(xt, 0, 1) * dnorm(y, xt, sigma) #     r &lt;- r1 / r2 #     if (u[i] &lt;= r) x[i] &lt;- y else #       x[i] &lt;- xt #   } #   return(x) # } #</code> # <code>{r} # set.seed(123) # sigma &lt;- 1.5 # k &lt;- 4 # n &lt;- 15000 # b &lt;- 500 # x0 &lt;- c(-10,-5,5,10) # X &lt;- matrix(0, nrow = k, ncol = n) # for (i in 1:k) { #   X[i,] &lt;- normal.chain(sigma, n, x0[i]) # } # psi &lt;- t(apply(X, 1, cumsum)) # for (i in 1:nrow(psi)) { #   psi[i,] &lt;- psi[i,]/(1:ncol(psi)) # } # rhat &lt;- rep(0, n) # for (j in (b+1):n){ #   rhat[j] &lt;- Gelman.Rubin(psi[,1:j]) # } # #作图 # plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;) # abline(h=1.2, lty=2) #</code></p>
<p>经调试发现<span class="math inline">\(\sigma\)</span>为1.5时，n=7500附近收敛</p>
<p>#9.8</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co">#生成卡方马氏链函数</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>f.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(m,x1){</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">2</span>;b <span class="ot">&lt;-</span> <span class="dv">2</span>;n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> x1 </span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#生成二项分布的边际发布</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>    x[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x[i,<span class="dv">1</span>]</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#生成贝塔分布的边际分布</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    x[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="r-set.seed123-k---4-n---5000-b---500-x0---c-1135-y0---runif4-x1-cbindx0y0-x--y--matrix0-nrow-k-ncol-n-for-i-in-1k-b-f.chainn-x1i-xi---b-1-yi---b-2" class="section level1">
<h1><code>{r} # set.seed(123) # k &lt;- 4 # n &lt;- 5000 # b &lt;- 500 # x0 &lt;- c(-1,1,3,5) # y0 &lt;- runif(4) # x1&lt;-cbind(x0,y0) # x &lt;-y&lt;- matrix(0, nrow = k, ncol = n) # for (i in 1:k) { #   B&lt;-f.chain(n, x1[i,]) #   x[i,] &lt;- B[ ,1] #   y[i,] &lt;- B[ ,2] # } #</code></h1>
</div>
<div id="r-psi---tapplyx-1-cumsum-for-i-in-1nrowpsi-psii---psii1ncolpsi-rhat---rep0-n-for-j-in-b1n-rhatj---gelman.rubinpsi1j-作边际x的图-plotrhatb1n-typel-xlab-ylabr-ablineh1.2-lty2" class="section level1">
<h1><code>{r} # psi &lt;- t(apply(x, 1, cumsum)) # for (i in 1:nrow(psi)) { #   psi[i,] &lt;- psi[i,]/(1:ncol(psi)) # } # rhat &lt;- rep(0, n) # for (j in (b+1):n){ #   rhat[j] &lt;- Gelman.Rubin(psi[,1:j]) # } # #作边际X的图 # plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;) # abline(h=1.2, lty=2) #</code></h1>
</div>
<div id="r-psi---tapplyy-1-cumsum-for-i-in-1nrowpsi-psii---psii1ncolpsi-rhat---rep0-n-for-j-in-b1n-rhatj---gelman.rubinpsi1j-作边际y的图-plotrhatb1n-typel-xlab-ylabr-ablineh1.2-lty2" class="section level1">
<h1><code>{r} # psi &lt;- t(apply(y, 1, cumsum)) # for (i in 1:nrow(psi)) { #   psi[i,] &lt;- psi[i,]/(1:ncol(psi)) # } # rhat &lt;- rep(0, n) # for (j in (b+1):n){ #   rhat[j] &lt;- Gelman.Rubin(psi[,1:j]) # } # #作边际Y的图 # plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;) # abline(h=1.2, lty=2)</code></h1>
</div>
<div id="the-homework-9" class="section level1">
<h1>The homework 9</h1>
<p>##Anwers</p>
<p>11.3</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a Write a function to compute</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(a,d,k){</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">/</span><span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span>(<span class="fu">sum</span>(a<span class="sc">*</span>a))<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  e<span class="ot">&lt;-</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span>b<span class="sc">*</span>c<span class="sc">*</span>e</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#b Modify the function so that it computes and returns the sum</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>n){</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">=</span> s <span class="sc">+</span> <span class="fu">f</span>(a,d,k)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(s)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#c Evaluate the sum</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">g</span>(n)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(s)</span></code></pre></div>
<pre><code>## [1] 9.817477</code></pre>
<p>通过输入不同的n,发现最终结果都一样，说明是收敛的</p>
<p>11.5</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First define the function to be called</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>ck<span class="ot">&lt;-</span><span class="cf">function</span>(k,a){</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>wf1 <span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">*</span>u<span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>wf2<span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">*</span>u<span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>wf3<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">gamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">integrate</span>(wf1,<span class="dv">0</span>,<span class="fu">ck</span>(k<span class="dv">-1</span>,a))<span class="sc">$</span>value<span class="dv">-2</span><span class="sc">*</span><span class="fu">gamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span>k)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">integrate</span>(wf2,<span class="dv">0</span>,<span class="fu">ck</span>(k,a))<span class="sc">$</span>value</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the root value of a under different values of k</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>kt<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">1</span>),<span class="dv">100</span>,<span class="dv">200</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>solution11<span class="fl">.5</span><span class="ot">&lt;-</span>solution11<span class="fl">.4</span><span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(kt))</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>js<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> kt) {</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>kt[js]</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  solution11<span class="fl">.5</span>[js]<span class="ot">&lt;-</span><span class="fu">uniroot</span>(wf3,<span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fu">sqrt</span>(k)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))<span class="sc">$</span>root</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  js<span class="ot">=</span>js<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Calculate 11.4, the root value of a with different values of k</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the root value of a with different values of k</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>js<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>wf4<span class="ot">&lt;-</span><span class="cf">function</span>(a){<span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k)}</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> kt) {</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>kt[js]</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  solution11<span class="fl">.4</span>[js]<span class="ot">&lt;-</span><span class="fu">uniroot</span>(wf4,<span class="fu">c</span>(<span class="fl">0.00001</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.0001</span>))<span class="sc">$</span>root</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  js<span class="ot">=</span>js<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(kt,solution11<span class="fl">.4</span>,solution11<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>##     kt solution11.4 solution11.5
## 1    4     1.492103     1.492103
## 2    5     1.533548     1.533567
## 3    6     1.562768     1.562719
## 4    7     1.584421     1.584429
## 5    8     1.601182     1.601183
## 6    9     1.614523     1.614522
## 7   10     1.625387     1.625383
## 8   11     1.634409     1.634409
## 9   12     1.642025     1.642019
## 10  13     1.648540     1.648540
## 11  14     1.654177     1.654194
## 12  15     1.659098     1.659120
## 13  16     1.663451     1.663408
## 14  17     1.667288     1.667273
## 15  18     1.670736     1.670724
## 16  19     1.673841     1.673817
## 17  20     1.676588     1.676607
## 18  21     1.679139     1.679154
## 19  22     1.681461     1.681479
## 20  23     4.795732     1.683578
## 21  24     4.898879     1.685521
## 22  25     4.999900     1.687347
## 23 100     9.999900     1.720600
## 24 200    14.142036     1.726318</code></pre>
<p>Analysis:These two questions almost give the same results using both methods.</p>
<p><span class="math inline">\(\textbf{Question3}\)</span></p>
<ol style="list-style-type: decimal">
<li><p>The observed data MLE <span class="math display">\[
  L(\lambda)=P(T&gt;\tau)^{n-n_{0}} \cdot \lambda^{-n_{0}} e^{-\frac{1}{\lambda} \sum_{i=1}^{n_{0}} y_{i}} 
\]</span> 其中<span class="math inline">\(n_{0}\)</span>为真实样本的个数，解得<span class="math inline">\(\lambda\)</span>的MLE为 <span class="math display">\[
  \hat{\lambda}=\frac{\tau\left(n-n_{0}\right)+\sum_{i=1}^{n_{0}} y_{i}}{n_{0}}
\]</span> So we get the observed data，which <span class="math inline">\(\tau=1, n=10, n_{0}=7\)</span>, and true observation data <span class="math inline">\(0.54,0.48,0.33,0.43,0.91,0.21,0.85\)</span>.</p></li>
<li><p>Use the <span class="math inline">\(E-M\)</span> algorithe to evaluate <span class="math inline">\(\lambda\)</span>. <span class="math display">\[
  L(\lambda)=\lambda^{-n} e^{-\frac{1}{\lambda}} \sum_{i=1}^{n} t_{i}\\
\]</span> (1)E step: <span class="math display">\[
Q\left(\lambda, \lambda^{(i)}\right)=E\left[\ln L(\lambda) \mid Y, \lambda^{(i)}\right]\\
=-n\ln  \lambda-\frac{1}{\lambda} \sum_{i=1}^{n} y_{i}-\frac{\left(n-n_{0}\right) \lambda^{(t)}}{\lambda}
\]</span></p></li>
<li><p>M step:maximization <span class="math display">\[
  \begin{aligned}
\frac{\partial Q\left(\lambda, \lambda^{(i)}\right)}{\partial \lambda}=&amp;-\frac{n}{\lambda}+\frac{\sum_{i=1}^{n} y_{i}+\left(n-n_{0}\right) \lambda^{(0)}}{\lambda^{2}}=0 \\
\lambda^{(i+1)} &amp;=\frac{1}{n} \sum_{i=1}^{n} y_{i}+\frac{n-n_{0}}{n} \lambda^{[i]}\\
\Rightarrow \bar{\lambda}=\frac{1}{n_{0}} \sum_{i=1}^{n} y_{i}
\end{aligned}
\]</span> Compare the estimation of EM algorithe and the observed data MLE: <span class="math display">\[
  \bar{\lambda}=\frac{1}{n_{0}} \sum_{i=1}^{n} y_{i} \\
\hat{\lambda}=\frac{\tau\left(n-n_{0}\right)+\sum_{j=1}^{n_{0}} y_{i}}{n_{0}}
\]</span></p></li>
</ol>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EM algorithe</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span>;n0<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">0.91</span>,<span class="fl">1.0</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  lambda[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  lambda[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(y)<span class="sc">+</span>(n<span class="sc">-</span>n0)<span class="sc">/</span>n<span class="sc">*</span>lambda[i]   <span class="co">#迭代过程</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(lambda[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span>lambda[i])<span class="sc">&lt;</span><span class="fl">1e-6</span>) <span class="cf">break</span>  <span class="co">#设定误差为小于1e-6</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  lambda_bar<span class="ot">&lt;-</span>lambda[i<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MLE</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span>;n0<span class="ot">&lt;-</span><span class="dv">7</span>;tau<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">0.91</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>lambda_hat<span class="ot">&lt;-</span>(tau<span class="sc">*</span>(n<span class="sc">-</span>n0)<span class="sc">+</span><span class="fu">sum</span>(y0))<span class="sc">/</span>n0</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(lambda_bar,lambda_hat),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 0.9642852 0.9642857</code></pre>
<p>结果发现EM算法和MLE结果十分接近</p>
</div>
<div id="the-homework-10" class="section level1">
<h1>The homework 10</h1>
<p>##Answer</p>
<p><span class="math inline">\(\textbf{Question1:}\)</span></p>
<p>Why are the following tow invocations of lappy() equivalent? <span class="math display">\[
  trims&lt;-c(0,0.1,0.2,0.5)\\
x&lt;-rcauchy(100)\\
lapply(trims,function(trims) mean(x,trim=trims))\\
lapply(trims,mean,x=x)
\]</span> #他们的运行结果相同是因为一个先调用函数再带入数据使用lappy,另一个直接带入数据调用lappy函数，所以出来的结果是相同的。</p>
<p><span class="math inline">\(\textbf{Question2:}\)</span></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the first model</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> <span class="fu">lapply</span>(j,<span class="cf">function</span>(j) {<span class="fu">rsq</span>(<span class="fu">lm</span>(formulas[[j]], <span class="at">data =</span> mtcars))})</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>wf</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the second model</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> <span class="fu">lapply</span>(j,<span class="cf">function</span>(j) {<span class="fu">rsq</span>(<span class="fu">lm</span>(formulas[[<span class="dv">1</span>]], <span class="at">data =</span> bootstraps[[j]]))})</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>wf</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7817567
## 
## [[2]]
## [1] 0.7813869
## 
## [[3]]
## [1] 0.7191574
## 
## [[4]]
## [1] 0.7880896
## 
## [[5]]
## [1] 0.6350857
## 
## [[6]]
## [1] 0.8092306
## 
## [[7]]
## [1] 0.7153903
## 
## [[8]]
## [1] 0.7117518
## 
## [[9]]
## [1] 0.6652465
## 
## [[10]]
## [1] 0.5906548</code></pre>
<p><span class="math inline">\(\textbf{Question3:}\)</span></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>su<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  funs<span class="ot">&lt;-</span><span class="fu">c</span>(sd)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(funs,<span class="cf">function</span>(f) <span class="fu">f</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">3</span>,<span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">10</span>)))</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(df,su,<span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    X1    X2    X3 
## 2.469 2.895 3.246</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">#b</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>su<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  funs<span class="ot">&lt;-</span><span class="fu">c</span>(sd)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(funs,<span class="cf">function</span>(f) <span class="fu">f</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">3</span>,<span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">10</span>)),<span class="fu">c</span>(<span class="fu">list</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)))</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(df,su,<span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): 强制改变过程中产生了NA

## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): 强制改变过程中产生了NA

## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): 强制改变过程中产生了NA</code></pre>
<pre><code>##    X1    X2    X3  X.A.  X.B.  X.C. 
## 2.578 2.740 2.556    NA    NA    NA</code></pre>
<p><span class="math inline">\(\textbf{Question4:}\)</span></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  l1<span class="ot">&lt;-</span><span class="cf">function</span>(mtcars) <span class="fu">glm</span>(mtcars<span class="sc">$</span>mpg <span class="sc">~</span> mtcars<span class="sc">$</span>disp),l2<span class="ot">&lt;-</span><span class="cf">function</span>(mtcars) <span class="fu">glm</span>(mtcars<span class="sc">$</span>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> mtcars<span class="sc">$</span>disp)),l3<span class="ot">&lt;-</span><span class="cf">function</span>(mtcars) <span class="fu">glm</span>(mtcars<span class="sc">$</span>mpg <span class="sc">~</span> mtcars<span class="sc">$</span>disp <span class="sc">+</span> mtcars<span class="sc">$</span>wt),l4<span class="ot">&lt;-</span><span class="cf">function</span>(mtcars) <span class="fu">glm</span>(mtcars<span class="sc">$</span>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> mtcars<span class="sc">$</span>disp) <span class="sc">+</span>mtcars<span class="sc">$</span>wt)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>cl<span class="ot">&lt;-</span><span class="fu">makeCluster</span>(<span class="dv">4</span>)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>bootstraps2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3000</span>, <span class="cf">function</span>(i) {</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]})</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(bootstraps2,formulas[[<span class="dv">1</span>]]))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 4.78 0.03 4.85</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">parSapply</span>(cl,bootstraps2,formulas[[<span class="dv">1</span>]]))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.75 0.10 3.65</code></pre>
<p><span class="math inline">\(\mathbf{Analysis:}\)</span>It can be seen from the results that multi-core is significantly faster than using the sapply function alone. I don’t think you can use multi-core for vapply because it cannot be unlisted.</p>
</div>
<div id="the-homework-11" class="section level1">
<h1>The homework 11</h1>
<p>##Anwerse</p>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#生成R函数</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>R_Gibbs<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b){</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#连的长度</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#定义一个二元变量</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>) <span class="co">#初始值</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#生成二项分布的随机数</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,x2)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#生成贝塔分布的随机数</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#生成Rcpp函数</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix C_Gibbs(int n,double a, double b){</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="st">            int N=10000;</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="st">            int x;</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="st">            double y;</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="st">            NumericMatrix M(N,2);</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="st">            M(0,0)=1;</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="st">            M(0,1)=0.5;</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="st">            for(int i=1;i&lt;N;i++){</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="st">            y=M(i-1,1);</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="st">            M(i,0)=rbinom(1,n,y)[0];</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="st">            x=M(i,0);</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="st">            M(i,1)=rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="st">            return(M) ;</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="st">            }&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)<span class="co">#设定随机种子</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span> <span class="co">#循环次数</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>GibbsR<span class="ot">=</span><span class="fu">R_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>) <span class="co">#调用函数</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>GibbsR<span class="ot">&lt;-</span>GibbsR[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>GibbsC<span class="ot">=</span><span class="fu">C_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>GibbsC<span class="ot">&lt;-</span>GibbsC[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co">#分别抽取边际变量值</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>GibbsR_x<span class="ot">&lt;-</span>GibbsR[,<span class="dv">1</span>]</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>GibbsR_y<span class="ot">&lt;-</span>GibbsR[,<span class="dv">2</span>]</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>GibbsC_x<span class="ot">&lt;-</span>GibbsC[,<span class="dv">1</span>]</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>GibbsC_y<span class="ot">&lt;-</span>GibbsC[,<span class="dv">2</span>]</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a><span class="co">#画QQ图</span></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(GibbsR_x,GibbsC_x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(GibbsR_y,GibbsC_y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co">#比较计算速度</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>time<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">GibbsR=</span><span class="fu">R_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>),<span class="at">GibbsC=</span><span class="fu">C_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(time)[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr        lq    median        uq
## 1 GibbsR 63.504051 65.501102 83.309001
## 2 GibbsC  4.841951  5.048701  6.424901</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
